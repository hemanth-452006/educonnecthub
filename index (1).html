<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EduConnect Hub</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
      rel="stylesheet"
    />

    <!-- â­ ADDED COLOR FOR TEACHER POPUP WINDOWS -->
    <style>
      .popup-window {
        background: #ffe6f2;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.15);
      }
    </style>
  </head>

  <body class="flex flex-col">
    <!-- LOGIN PAGE -->
    <section id="loginPage" class="login-section">
      <div class="login-container">
        <h1 class="title mb-6">Welcome to EduConnect Hub</h1>

        <div id="loginChoice" class="login-choice">
          <button class="choice-btn" onclick="showLogin('student')">
            ğŸ§‘â€ğŸ“ Login as Student
          </button>
          <button class="choice-btn" onclick="showLogin('teacher')">
            ğŸ‘©â€ğŸ« Login as Teacher
          </button>
        </div>

        <form id="studentForm" class="login-form hidden">
          <h2 class="form-title">Student Login</h2>
          <input
            type="text"
            id="studentUser"
            placeholder="Student Username"
            required
          />
          <input
            type="password"
            id="studentPass"
            placeholder="Password"
            required
          />
          <button type="submit" class="login-btn">Login</button>
          <p id="studentError" class="error-msg hidden">
            âŒ Invalid Student Credentials
          </p>
          <button type="button" class="back-btn" onclick="backToChoice()">
            â¬… Back
          </button>
        </form>

        <form id="teacherForm" class="login-form hidden">
          <h2 class="form-title">Teacher Login</h2>
          <input
            type="text"
            id="teacherUser"
            placeholder="Teacher Username"
            required
          />
          <input
            type="password"
            id="teacherPass"
            placeholder="Password"
            required
          />
          <button type="submit" class="login-btn">Login</button>
          <p id="teacherError" class="error-msg hidden">
            âŒ Invalid Teacher Credentials
          </p>
          <button type="button" class="back-btn" onclick="backToChoice()">
            â¬… Back
          </button>
        </form>
      </div>
    </section>

    <!-- STUDENT DASHBOARD -->
    <section
      id="studentDashboard"
      class="hidden fade min-h-screen flex flex-col"
    >
      <header>
        <h1 class="text-xl font-bold">EduConnect Hub</h1>
        <div>
          <span>Welcome, <span id="studentName">Aman</span> (Section A)</span>
          <button onclick="backToLogin()" class="logout-btn">Logout</button>
        </div>
      </header>

      <div class="flex flex-1">
        <aside class="sidebar p-4">
          <nav class="flex flex-col gap-2">
            <button class="tab-btn active-tab" data-tab="courses">
              ğŸ« Courses
            </button>
            <button class="tab-btn" data-tab="marks">ğŸ“Š Results / Marks</button>
            <button class="tab-btn" data-tab="attendance">ğŸ—“ï¸ Attendance</button>
            <button class="tab-btn" data-tab="leaderboard">
              ğŸ† Leaderboard
            </button>
            <button class="tab-btn" data-tab="feedback">ğŸ’¬ Feedback</button>
            <button class="tab-btn" data-tab="timetable">â° Timetable</button>
          </nav>
        </aside>

        <main class="flex-1 p-6 overflow-y-auto">
          <section id="courses" class="tab-content fade">
            <h2 class="text-xl font-bold mb-3">My Courses</h2>

            <div class="grid md:grid-cols-3 gap-4">
              <!-- teacher card 1 -->
              <div
                class="teacher-card"
                data-teacher-id="42"
                data-teacher-name="Ms. Rao"
                role="group"
                tabindex="0"
                aria-label="Web Development â€” Ms. Rao"
              >
                <div class="card-body">
                  <h3>Web Development</h3>
                  <p>Instructor: Ms. Rao</p>
                </div>

                <!-- floating message button (hidden until hover or focus-within) -->
                <button
                  class="msg-floating"
                  type="button"
                  aria-label="Message Ms. Rao"
                  title="Message Ms. Rao"
                >
                  ğŸ’¬
                </button>
              </div>

              <!-- teacher card 2 -->
              <div
                class="teacher-card"
                data-teacher-id="43"
                data-teacher-name="Mr. Mehta"
                role="group"
                tabindex="0"
                aria-label="Data Structures â€” Mr. Mehta"
              >
                <div class="card-body">
                  <h3>Data Structures</h3>
                  <p>Instructor: Mr. Mehta</p>
                </div>
                <button
                  class="msg-floating"
                  type="button"
                  aria-label="Message Mr. Mehta"
                  title="Message Mr. Mehta"
                >
                  ğŸ’¬
                </button>
              </div>

              <!-- teacher card 3 -->
              <div
                class="teacher-card"
                data-teacher-id="44"
                data-teacher-name="Mrs. Kapoor"
                role="group"
                tabindex="0"
                aria-label="DBMS â€” Mrs. Kapoor"
              >
                <div class="card-body">
                  <h3>DBMS</h3>
                  <p>Instructor: Mrs. Kapoor</p>
                </div>
                <button
                  class="msg-floating"
                  type="button"
                  aria-label="Message Mrs. Kapoor"
                  title="Message Mrs. Kapoor"
                >
                  ğŸ’¬
                </button>
              </div>
            </div>

            <div id="teacherToolArea" class="hidden w-11/12 mt-6">
              <!-- content will be injected here by appended JS -->
            </div>
          </section>

          <!-- (Optional) reference image used during design: /mnt/data/0b7919ae-753f-48e4-b71b-e355306daddc.png -->

          <section id="marks" class="tab-content hidden fade">
            <h2 class="text-xl font-bold mb-3">Results / Marks</h2>
            <table class="data-table">
              <thead>
                <tr>
                  <th>Subject</th>
                  <th>Marks</th>
                </tr>
              </thead>
              <tbody id="marksTable"></tbody>
            </table>
            <canvas id="marksChart" class="mt-6"></canvas>
          </section>

          <section id="attendance" class="tab-content hidden fade">
            <h2 class="text-xl font-bold mb-3">Attendance</h2>
            <table class="data-table">
              <thead>
                <tr>
                  <th>Subject</th>
                  <th>Attendance (%)</th>
                </tr>
              </thead>
              <tbody id="attendanceTable"></tbody>
            </table>
            <canvas id="attendanceChart" class="mt-6"></canvas>
          </section>

          <section id="leaderboard" class="tab-content hidden fade">
            <h2 class="text-xl font-bold mb-3">Leaderboard</h2>
            <div id="leaderboardList" class="grid md:grid-cols-3 gap-4"></div>
          </section>

          <section id="feedback" class="tab-content hidden fade">
            <h2 class="text-xl font-bold mb-3">Submit Feedback</h2>
            <div class="feedback-box">
              <textarea
                id="feedbackInput"
                placeholder="Write your feedback..."
              ></textarea>
              <button onclick="submitFeedback()" class="submit-btn">
                Submit
              </button>
              <p id="feedbackMsg" class="hidden mt-2 text-green-600">
                âœ… Feedback submitted!
              </p>
            </div>
          </section>

          <section id="timetable" class="tab-content hidden fade">
            <h2 class="text-xl font-bold mb-3">Weekly Timetable</h2>
            <table class="data-table">
              <thead>
                <tr>
                  <th>Day</th>
                  <th>9-10</th>
                  <th>10-11</th>
                  <th>11:15-12:15</th>
                  <th>1-2</th>
                  <th>2-3</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Mon</td>
                  <td>Web Dev</td>
                  <td>DBMS</td>
                  <td>DS</td>
                  <td>Break</td>
                  <td>Library</td>
                </tr>
                <tr>
                  <td>Tue</td>
                  <td>DBMS</td>
                  <td>Web Dev</td>
                  <td>DS</td>
                  <td>Break</td>
                  <td>Sports</td>
                </tr>
                <tr>
                  <td>Wed</td>
                  <td>DS</td>
                  <td>DBMS</td>
                  <td>Web Dev</td>
                  <td>Break</td>
                  <td>Library</td>
                </tr>
                <tr>
                  <td>Thu</td>
                  <td>Web Dev</td>
                  <td>DS</td>
                  <td>DBMS</td>
                  <td>Break</td>
                  <td>Workshop</td>
                </tr>
                <tr>
                  <td>Fri</td>
                  <td>DBMS</td>
                  <td>Web Dev</td>
                  <td>Project</td>
                  <td>Break</td>
                  <td>Sports</td>
                </tr>
              </tbody>
            </table>
          </section>
        </main>
      </div>

      <div id="announcementPopup" class="announcement-popup hidden">
        <h3>ğŸ“¢ New Announcement</h3>
        <p id="announcementText"></p>
        <button onclick="markAnnouncementSeen()" class="submit-btn">
          Mark as Seen
        </button>
      </div>
    </section>

    <!-- TEACHER DASHBOARD -->
    <section
      id="teacherDashboard"
      class="hidden fade min-h-screen flex flex-col"
    >
      <header>
        <h1 class="text-xl font-bold">EduConnect Hub</h1>
        <div>
          <span>Welcome, <span id="teacherName">Ms. Sharma</span></span>
          <button onclick="backToLogin()" class="logout-btn">Logout</button>
        </div>
      </header>

      <main class="flex-1 flex flex-col items-center text-center p-10">
        <h2 class="text-2xl font-bold mb-4">Teacher Dashboard</h2>
        <p class="max-w-xl mb-6">
          Welcome Ms. Sharma! You teach <strong>Web Development</strong> for
          Sections A, B, and C.
        </p>

        <div class="grid gap-6 md:grid-cols-3" id="teacherButtonsGrid">
          <button class="teacher-btn" onclick="openSchedule()">
            ğŸ“… View Schedule
          </button>
          <button class="teacher-btn" onclick="openAttendance()">
            ğŸ—’ï¸ Take Attendance
          </button>
          <button class="teacher-btn" onclick="openMarksEntry()">
            ğŸ§¾ Enter Marks
          </button>
          <button class="teacher-btn" onclick="openResultChart()">
            ğŸ“Š View Result Chart
          </button>
          <button class="teacher-btn" onclick="openAnnouncements()">
            ğŸ“¢ Announcements
          </button>
          <button class="teacher-btn" onclick="openFeedback()">
            ğŸ’¬ See Feedback
          </button>
          <button
            class="teacher-btn"
            id="btnAddStudent"
            type="button"
            onclick="openAddStudentModal()"
          >
            â• Add Student
          </button>
          <button
            class="teacher-btn"
            id="btnTeacherMessages"
            type="button"
            onclick="openTeacherMessages()"
          >
            ğŸ’¬ Messages
          </button>
        </div>

        <!-- INLINE TOOL AREA (hidden until needed) -->
        <div id="teacherToolArea" class="hidden w-11/12 mt-6">
          <!-- content will be injected here by appended JS -->
        </div>
      </main>
    </section>
    <!-- MESSAGE MODAL (hidden by default) -->
    <div
      id="msg-modal"
      class="msg-modal"
      aria-hidden="true"
      style="display: none"
    >
      <div class="msg-modal-backdrop" data-close></div>

      <div
        class="msg-modal-panel"
        role="dialog"
        aria-modal="true"
        aria-labelledby="msg-modal-title"
      >
        <button class="modal-close" aria-label="Close message composer">
          âœ•
        </button>
        <h3 id="msg-modal-title">Message</h3>

        <form id="msg-form">
          <input
            type="hidden"
            id="to_teacher_id"
            name="to_teacher_id"
            value=""
          />

          <!-- âœ… ADD THIS HIDDEN FIELD FOR STUDENT NAME -->
          <input type="hidden" id="msg-sender" name="sender" value="" />

          <label for="msg-subject">Subject</label>
          <input
            type="text"
            id="msg-subject"
            name="subject"
            required
            maxlength="80"
          />

          <label for="msg-body">Message</label>
          <textarea id="msg-body" name="body" rows="6" required></textarea>

          <div class="modal-actions">
            <button type="submit" class="btn-primary">Send</button>
            <button type="button" id="msg-redirect" class="btn-secondary">
              Open full messages
            </button>
          </div>
        </form>
      </div>
    </div>
    <!-- ADD STUDENT MODAL -->
    <div
      id="add-student-modal"
      class="msg-modal"
      aria-hidden="true"
      style="display: none"
    >
      <div class="msg-modal-backdrop" data-close></div>
      <div
        class="msg-modal-panel"
        role="dialog"
        aria-modal="true"
        aria-labelledby="add-student-title"
      >
        <button class="modal-close" aria-label="Close">âœ•</button>
        <h3 id="add-student-title">Add Student Details</h3>
        <form id="add-student-form">
          <label for="stu-name">Name</label>
          <input id="stu-name" name="name" required />
          <label for="stu-roll">Roll No</label>
          <input id="stu-roll" name="roll" required />
          <label for="stu-section">Section</label>
          <input id="stu-section" name="section" required />
          <label for="stu-notes">Notes (optional)</label>
          <textarea id="stu-notes" name="notes" rows="3"></textarea>

          <div
            style="
              display: flex;
              gap: 8px;
              justify-content: flex-end;
              margin-top: 8px;
            "
          >
            <button type="submit" class="btn-primary">Save</button>
            <button type="button" class="btn-secondary" data-close>
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>
    <!-- TEACHER MESSAGES (INBOX) -->
    <div
      id="teacher-inbox-modal"
      class="msg-modal"
      aria-hidden="true"
      style="display: none"
    >
      <div class="msg-modal-backdrop" data-close></div>
      <div
        class="msg-modal-panel"
        role="dialog"
        aria-modal="true"
        aria-labelledby="teacher-inbox-title"
      >
        <button class="modal-close" aria-label="Close">âœ•</button>
        <h3 id="teacher-inbox-title">Messages</h3>

        <div id="inbox-list" style="margin-top: 12px">
          <!-- messages will be injected here -->
          <p class="muted">No messages yet.</p>
        </div>

        <div
          style="
            display: flex;
            gap: 8px;
            justify-content: flex-end;
            margin-top: 10px;
          "
        >
          <button id="inbox-refresh" class="btn-secondary" type="button">
            Refresh
          </button>
          <button id="inbox-clear" class="btn-secondary" type="button">
            Clear All
          </button>
        </div>
      </div>
    </div>

    <!-- ANNOUNCEMENTS - Section-specific posting -->
    <div
      id="announcementsCard"
      class="announcements-card"
      style="
        background: #fff;
        padding: 22px;
        border-radius: 10px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.06);
      "
    >
      <h2 style="color: #2563eb; margin: 0 0 12px 0">Create Announcement</h2>

      <textarea
        id="announceInput"
        rows="3"
        placeholder="Write announcement..."
        style="
          width: 100%;
          padding: 14px;
          border-radius: 8px;
          border: 2px solid #dbeafe;
          box-sizing: border-box;
        "
      ></textarea>

      <div
        style="margin-top: 12px; display: flex; gap: 10px; align-items: center"
      >
        <!-- Section buttons -->
        <button
          class="post-section-btn"
          data-section="A"
          style="
            background: #2563eb;
            color: #fff;
            padding: 10px 14px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
          "
        >
          Post â†’ Section A
        </button>
        <button
          class="post-section-btn"
          data-section="B"
          style="
            background: #2563eb;
            color: #fff;
            padding: 10px 14px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
          "
        >
          Post â†’ Section B
        </button>
        <button
          class="post-section-btn"
          data-section="C"
          style="
            background: #2563eb;
            color: #fff;
            padding: 10px 14px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
          "
        >
          Post â†’ Section C
        </button>

        <!-- small helper: choose which section's history is shown -->
        <div style="margin-left: 18px">
          <label for="viewSection" style="font-weight: 600; margin-right: 6px"
            >Show:</label
          >
          <select
            id="viewSection"
            style="padding: 8px; border-radius: 6px; border: 1px solid #cbd5e1"
          >
            <option value="A">Section A</option>
            <option value="B">Section B</option>
            <option value="C">Section C</option>
          </select>
        </div>
      </div>

      <h3 style="color: #1f3ea8; margin-top: 18px">Previous Announcements</h3>
      <div
        id="announcementList"
        style="
          margin-top: 10px;
          display: flex;
          flex-direction: column;
          gap: 8px;
        "
      >
        <!-- populated by JS -->
      </div>
    </div>

    <script src="script.js"></script>
  </body>
</html>
